{% extends 'base.html' %}
{% load static %}

{% block content %}

<div class="container-register">
    
    <div class="form-container form-register">
        <div class="logo">RailTrip</div>
        <h2>Créer un compte</h2>
        <form method="post" id="registerForm">
            {% csrf_token %}
            
            <div class="register-center">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="username">Nom d'utilisateur : </label>
                        <input type="text" id="username" name="username" placeholder="jean.dupont" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="password">Mot de passe : </label>
                        <input type="password" id="password" name="password" placeholder="••••••••" required>
                        <div class="password-strength">
                            <div class="password-strength-bar"></div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="password_confirm">Confirmer le mot de passe : </label>
                        <input type="password" id="password_confirm" name="password_confirm" placeholder="••••••••" required>
                    </div>
                </div>
            </div>

            <div class="terms-checkbox">
                <label class="remember-me">
                    <input type="checkbox" name="terms" required>
                    <span class="checkbox-condition">J'accepte les <a href="#" class="text-primary">conditions d'utilisation</a> et la <a href="#" class="text-primary">politique de confidentialité</a></span>
                </label>
            </div>

            {% if form.errors %}
            <div class="error-message">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                    <path d="M8 14A6 6 0 108 2a6 6 0 000 12zM8 5v4M8 11h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                {% for field in form %}
                    {% for error in field.errors %}
                        {{ error }}
                    {% endfor %}
                {% endfor %}
            </div>
            {% endif %}

            <button type="submit" class="button">Se connecter</button>

        </form>

        
        <div class="register-section">
            <p>
                Déjà un compte ? <a href="{% url 'login' %}" class="register-link">Se connecter</a>
            </p>
        </div>
    </div>
    {% endblock content %}
</div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('registerForm');
            const passwordInput = document.getElementById('password');
            const confirmPasswordInput = document.getElementById('password_confirm');
            const strengthBar = document.querySelector('.password-strength-bar');

            // Validation du mot de passe
            passwordInput.addEventListener('input', function() {
                const password = this.value;
                let strength = 0;
                
                if(password.length >= 8) strength++;
                if(/[A-Z]/.test(password)) strength++;
                if(/[0-9]/.test(password)) strength++;
                if(/[^A-Za-z0-9]/.test(password)) strength++;

                strengthBar.className = 'password-strength-bar';
                
                if(strength >= 4) {
                    strengthBar.classList.add('strength-strong');
                } else if(strength >= 2) {
                    strengthBar.classList.add('strength-medium');
                } else {
                    strengthBar.classList.add('strength-weak');
                }
            });

            // Validation du formulaire
            form.addEventListener('submit', function(e) {
                if(passwordInput.value !== confirmPasswordInput.value) {
                    e.preventDefault();
                    alert('Les mots de passe ne correspondent pas');
                }
            });
        });
    </script>
</body>
</html>